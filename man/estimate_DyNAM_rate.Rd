% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{estimate_DyNAM_rate}
\alias{estimate_DyNAM_rate}
\title{Calculation for estimating an DyNAM-rate model}
\usage{
estimate_DyNAM_rate(
  parameters,
  dep_event_mat,
  timespan,
  is_dependent,
  stat_mat_init,
  stat_mat_update,
  stat_mat_update_pointer,
  stat_mat_rightcensored_update,
  stat_mat_rightcensored_update_pointer,
  presence1_init,
  presence1_update,
  presence1_update_pointer,
  presence2_init,
  presence2_update,
  presence2_update_pointer,
  n_actors_1,
  n_actors_2,
  twomode_or_reflexive,
  impute = TRUE
)
}
\arguments{
\item{parameters}{An n_parameters by 1 matrix, which is the input parameter}

\item{dep_event_mat}{An 2 by n_events matrix, the (1,n) entry is the sender of n-th event,
and the (2,n) entry is the receiver of the n-th event.}

\item{timespan}{An n_events by 1 matrix. The i-th element is the waiting time of the i-th event.}

\item{is_dependent}{An n_events by 1 matrix with boolean values. If the i-th event is dependent,
then the i-th entry of is_dependent is TRUE, otherwise it's FALSE.}

\item{stat_mat_init}{An n_actor1*n_actor2 by n_parameters matrix. It is the initialization of the statistics matrix.
The initial value of k-th effect for the actor1-actor2 pair (i,j) is recorded in
the ((i-1)*n_actor2 + j,k) entry of stat_mat_init.}

\item{stat_mat_update}{An matrix with four rows, which records the updates of the statistics matrix through all dependent events.
The following is an example.
\tabular{rrrrr}{
  0 \tab 2 \tab 0 \tab 9 \tab 9\cr
  2 \tab 1 \tab 5 \tab 4 \tab 3\cr
  3 \tab 5 \tab 5 \tab  0 \tab 5\cr
  1.2 \tab 3.5 \tab 2.5 \tab 9.23 \tab 2.8\cr
}
Each column represents an update. For example the first column means replacing the value of the (3+1)-th effect
for the actor1-actor2 pair(0+1,2+1) by 1.2. The +1 is due to the difference between the numberings in R and C.}

\item{stat_mat_update_pointer}{An n_events by 1 matrix that record which update belongs to which rightcensored event.
The structure is similar to stat_mat_update_pointer.}

\item{stat_mat_rightcensored_update}{An matrix with four rows,
which record the updates of the statistics matrix through all right-censored events.
the structure is similar to stat_mat_update.}

\item{presence1_init}{An n_actor1 by 1 matrix, which records the initial presence of each actor1.
If the i-th actor1 is not present in the
 beginning then the i-th entry of presence1_init is 0, otherwise it's 1.}

\item{presence1_update}{An matrix with two rows, which record the updates of the presence of actor1 through all events.
The following is an example.
\tabular{rrrrr}{
  0 \tab 3 \tab 4 \tab 9 \tab 20\cr
  1 \tab 0 \tab 1 \tab 0 \tab 0\cr
}
Each column represents an update. For example the first column means the 0+1-th actor1 becomes present.
And the second column means the
the 3+1 th actor1 becomes absent. The +1 is due to the difference between the numberings in R and C.}

\item{presence2_init}{An n_actors2 by 1 matrix, which records the initial presence of each actor2.
If the i-th actor2 is not present in the beginning then the i-th entry of presence2_init is 0, otherwise it's 1.}

\item{presence2_update}{An matrix with two rows, which record the updates of the presence of actor2 through all events.
The following is an example.
\tabular{rrrrr}{
  0 \tab 3 \tab 4 \tab 9 \tab 20\cr
  1 \tab 0 \tab 1 \tab 0 \tab 0\cr
}
Each column represents an update. For example the first column means the 0+1-th actor2 becomes present.
And the second column means the
the 3+1 th actor2 becomes absent. The +1 is due to the difference between the numberings in R and C.}

\item{presence2_update_pointer}{An n_events by 1 matrix that record which update belongs to which (dependent+ rightcensored) event.
The structure is similar to stat_mat_update_pointer.}

\item{n_actors_1}{An integer which is the number of actor1}

\item{n_actors_2}{An integer which is the number of actor2}

\item{twomode_or_reflexive}{An boolean variable. If it's true, then the model is two-model
or we consider the reflexive effect (that's the value in the diagonal entries of the statistics matrix).}

\item{impute}{An boolean variable. If it true, the function does the imputation for missing values.}
}
\value{
Return a list with elements as follows.
\describe{
  \item{derivative}{An 1 by n_parameters matrix, which is the derivative of loglikelihood given the input parameter and data.}
  \item{fisher}{An n_parameters by n_parameters matrix, which is the fisher information matrix given the input parameter and data.}
  \item{logLikelihood}{An scalar, which is the loglikelihood given the input parameter and data.}
  \item{intervalLogL}{An n_events by 1 matrix,
        of which the i-th entry is the loglikelihood of the i-th event given the input parameter and data.}
}
}
\description{
Given input data, it output the derivative of the loglikelihood, the Fisher information matrix, the logLikelihood,
    and the loglikelihood of each event
}
\keyword{internal}
